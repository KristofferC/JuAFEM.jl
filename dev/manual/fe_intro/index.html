<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to FEM · JuAFEM.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>JuAFEM.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li class="current"><a class="toctext" href>Introduction to FEM</a><ul class="internal"><li><a class="toctext" href="#Strong-format-1">Strong format</a></li><li><a class="toctext" href="#Weak-format-1">Weak format</a></li><li><a class="toctext" href="#FE-approximation-1">FE-approximation</a></li><li><a class="toctext" href="#Implementation-1">Implementation</a></li></ul></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../degrees_of_freedom/">Degrees of Freedom</a></li><li><a class="toctext" href="../assembly/">Assembly</a></li><li><a class="toctext" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="toctext" href="../grid/">Grid</a></li><li><a class="toctext" href="../export/">Export</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../examples/heat_equation/">Heat Equation</a></li><li><a class="toctext" href="../../examples/incompressible_elasticity/">Incompressible Elasticity</a></li><li><a class="toctext" href="../../examples/hyperelasticity/">Hyperelasticity</a></li><li><a class="toctext" href="../../examples/threaded_assembly/">Threaded Assembly</a></li><li><a class="toctext" href="../../examples/plasticity/">von Mises plasticity</a></li></ul></li><li><span class="toctext">API Reference</span><ul><li><a class="toctext" href="../../reference/quadrature/">Quadrature</a></li><li><a class="toctext" href="../../reference/interpolations/">Interpolation</a></li><li><a class="toctext" href="../../reference/fevalues/">FEValues</a></li><li><a class="toctext" href="../../reference/dofhandler/">DofHandler</a></li><li><a class="toctext" href="../../reference/assembly/">Assembly</a></li><li><a class="toctext" href="../../reference/boundary_conditions/">Boundary Conditions</a></li><li><a class="toctext" href="../../reference/grid/">Grid</a></li><li><a class="toctext" href="../../reference/export/">Export</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Introduction to FEM</a></li></ul><a class="edit-page" href="https://github.com/KristofferC/JuAFEM.jl/blob/master/docs/src/manual/fe_intro.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Introduction to FEM</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Introduction-to-FEM-1" href="#Introduction-to-FEM-1">Introduction to FEM</a></h1><p>Here we will present a very brief introduction to partial differential equations (PDEs) and to the finite element method (FEM). Perhaps the simplest PDE of all is the (linear) heat equation, also known as the Laplace equation. We will use this equation as a demonstrative example of the method, and demonstrate how we go from the strong format of the equation, to the weak form, and then finally to the discrete FE problem.</p><h2><a class="nav-anchor" id="Strong-format-1" href="#Strong-format-1">Strong format</a></h2><p>The strong format of the heat equation may be written as:</p><div>\[- \mathbf{\nabla} \cdot \mathbf{q}(u) = b \quad x \in \Omega,\]</div><p>where <span>$u$</span> is the unknown temperature field, <span>$\mathbf{q}$</span> is the heat flux and <span>$b$</span> is an internal heat source. To complete the system of equations we need boundary conditions. There are different types of boundary conditions, but the most common ones are Dirichlet – which means that the solution <span>$u$</span> is known at some part of the boundary, and Neumann – which means that the gradient of the solution, <span>$\mathbf{\nabla}$</span> is known. For example</p><div>\[u = u^\mathrm{p} \quad \forall \mathbf{x} \in \Gamma_\mathrm{D},\\
\mathbf{q} \cdot \mathbf{n} = q^\mathrm{p} \quad \forall \mathbf{x} \in \Gamma_\mathrm{N},\]</div><p>i.e. the temperature is presribed to <span>$u^\mathrm{p}$</span> at the Dirichlet part of the boundary, <span>$\Gamma_\mathrm{D}$</span>, and the heat flux is prescribed to <span>$q^\mathrm{p}$</span> at the Neumann part of the boundary, <span>$\Gamma_\mathrm{N}$</span>.</p><p>We also need a constitutive equation which links the temperature field, <span>$u$</span>, to the heat flux, <span>$\mathbf{q}$</span>. The simplest case is to use Fourier&#39;s law</p><div>\[\mathbf{q} = -k \mathbf{\nabla}u\]</div><p>where <span>$k$</span> is the conductivity of the material. For simplicity we will consider only constant conductivity <span>$k$</span>.</p><h2><a class="nav-anchor" id="Weak-format-1" href="#Weak-format-1">Weak format</a></h2><p>The solution to the equation above is usually calculated from the corresponding weak format. By multiplying the equation with an arbitrary test function <span>$\delta u$</span>, integrating over the domain and using partial integration we obtain the <em>weak form</em>; Find <span>$u \in \mathbb{U}$</span> s.t.</p><div>\[\int_\Omega \mathbf{\delta u} \cdot (k \mathbf{u}) \mathrm{d}\Omega =
\int_{\Gamma_\mathrm{N}} \delta u q^\mathrm{p} \mathrm{d}\Gamma +
\int_\Omega \delta u b \mathrm{d}\Omega \quad \forall \delta u \in \mathbb{U}^0\]</div><p>where <span>$\mathbb{U}, \mathbb{U}^0$</span> are function spaces with sufficiently regular functions. It can be shown that the solution to the weak form is identical to the solution to the strong format.</p><h2><a class="nav-anchor" id="FE-approximation-1" href="#FE-approximation-1">FE-approximation</a></h2><p>We now introduce the finite element approximation <span>$u_h \approx u$</span> as a sum of shape functions, <span>$N_i$</span> and nodal values, <span>$a_i$</span>. We approximate the test function in the same way (known as the Galerkin method):</p><div>\[u_\mathrm{h} = \sum_{i=1}^{\mathrm{N}} N_i a_i,\qquad
\delta u_\mathrm{h} = \sum_{i=1}^{\mathrm{N}} N_i \delta a_i\]</div><p>We may now inserted these approximations in the weak format, which results in</p><div>\[\sum_i^N \sum_j^N \delta a_i \int_\Omega \mathbf{\nabla} N_i \cdot (k \cdot \mathbf{\nabla} N_j) \mathrm{d}\Omega a_j =
\sum_i^N \delta a_i \int_\Gamma N_i q^\mathrm{p} \mathrm{d}\Gamma +
\sum_i^N \delta a_i \int_\Omega N_i b \mathrm{d}\Omega\]</div><p>Since <span>$\delta u$</span> can be chosen arbitrary, the nodal values <span>$\delta a_i$</span> can be chosen arbitrary. Thus, the equation can be written as a linear system of equations</p><div>\[\underline{K}\ \underline{a} = \underline{f}\]</div><p>where <span>$\underline{K}$</span> is the (tangent) stiffness matrix, <span>$\underline{a}$</span> is the solution vector with the nodal values and <span>$\underline{f}$</span> is the force vector. The elements of <span>$\underline{K}$</span> and <span>$\underline{f}$</span> are given by</p><div>\[\underline{K}_{ij} =
    \int_\Omega \mathbf{\nabla}N_i \cdot (k \cdot \mathbf{\nabla}N_j) \mathrm{d}\Omega\\

\underline{f}_{i} =
    \int_\Gamma N_i q^\mathrm{p} \mathrm{d}\Gamma + \int_\Omega N_i b \mathrm{d}\Omega\]</div><p>The solution to the system (which in this case is linear) is simply given by inverting the matrix <span>$\underline{K}$</span>. We also need to take care of the Dirichlet boundary conditions, by enforcing the correct nodal values <span>$a_i$</span> to the prescribed values.</p><div>\[\underline{a} = \underline{K}^{-1}\ \underline{f}\]</div><h2><a class="nav-anchor" id="Implementation-1" href="#Implementation-1">Implementation</a></h2><p>In practice, the shape functions <span>$N$</span> are only non-zero on parts of the domain <span>$\Omega$</span>. Thus, the integrals are evaluated on sub-domains, called <em>elements</em> or <em>cells</em>. Each cell gives a contribution to the global stiffness matrix and force vector. For a solution of the heat equation, as implemented in <code>JuAFEM</code>, check out <a href="../../examples/heat_equation/#Heat-Equation-1">this thoroughly commented example</a>.</p><footer><hr/><a class="previous" href="../../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../degrees_of_freedom/"><span class="direction">Next</span><span class="title">Degrees of Freedom</span></a></footer></article></body></html>
